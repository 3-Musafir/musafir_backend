{"file":"/Users/devprofile/Documents/GitHub/musafir_backend/src/payment/refund-policy.util.spec.ts","mappings":"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","names":[],"sources":["/Users/devprofile/Documents/GitHub/musafir_backend/src/payment/refund-policy.util.spec.ts"],"sourcesContent":["import {\n  computeRefundQuote,\n  REFUND_POLICY_LINK,\n  REFUND_PROCESSING_FEE_PKR,\n} from './refund-policy.util';\n\ndescribe('computeRefundQuote', () => {\n  const flagshipStartDate = new Date('2026-02-15T00:00:00+05:00');\n\n  it('applies 100% for 15+ days before departure', () => {\n    const submittedAt = new Date('2026-01-31T10:00:00+05:00'); // 15 days before (PKT)\n    const quote = computeRefundQuote({\n      flagshipStartDate,\n      submittedAt,\n      amountPaid: 10000,\n    });\n\n    expect(quote.daysBeforeDeparture).toBe(15);\n    expect(quote.refundPercent).toBe(100);\n    expect(quote.tierLabel).toBe('15+ days');\n    expect(quote.processingFee).toBe(REFUND_PROCESSING_FEE_PKR);\n    expect(quote.refundAmount).toBe(9500);\n    expect(quote.policyLink).toBe(REFUND_POLICY_LINK);\n  });\n\n  it('applies 50% for 10-14 days before departure (inclusive)', () => {\n    const submittedAt = new Date('2026-02-05T10:00:00+05:00'); // 10 days before\n    const quote = computeRefundQuote({\n      flagshipStartDate,\n      submittedAt,\n      amountPaid: 10000,\n    });\n\n    expect(quote.daysBeforeDeparture).toBe(10);\n    expect(quote.refundPercent).toBe(50);\n    expect(quote.tierLabel).toBe('10-14 days');\n    expect(quote.refundAmount).toBe(4500);\n  });\n\n  it('applies 30% for 5-9 days before departure (inclusive)', () => {\n    const submittedAt = new Date('2026-02-10T10:00:00+05:00'); // 5 days before\n    const quote = computeRefundQuote({\n      flagshipStartDate,\n      submittedAt,\n      amountPaid: 10000,\n    });\n\n    expect(quote.daysBeforeDeparture).toBe(5);\n    expect(quote.refundPercent).toBe(30);\n    expect(quote.tierLabel).toBe('5-9 days');\n    expect(quote.refundAmount).toBe(2500);\n  });\n\n  it('applies 0% for 0-4 days before departure (inclusive)', () => {\n    const submittedAt = new Date('2026-02-11T10:00:00+05:00'); // 4 days before\n    const quote = computeRefundQuote({\n      flagshipStartDate,\n      submittedAt,\n      amountPaid: 10000,\n    });\n\n    expect(quote.daysBeforeDeparture).toBe(4);\n    expect(quote.refundPercent).toBe(0);\n    expect(quote.tierLabel).toBe('0-4 days');\n    expect(quote.refundAmount).toBe(0);\n  });\n\n  it('never returns a negative refund amount', () => {\n    const submittedAt = new Date('2026-01-31T10:00:00+05:00'); // 15+ days\n    const quote = computeRefundQuote({\n      flagshipStartDate,\n      submittedAt,\n      amountPaid: 200,\n    });\n\n    expect(quote.refundPercent).toBe(100);\n    expect(quote.refundAmount).toBe(0);\n  });\n});\n\n"],"version":3}