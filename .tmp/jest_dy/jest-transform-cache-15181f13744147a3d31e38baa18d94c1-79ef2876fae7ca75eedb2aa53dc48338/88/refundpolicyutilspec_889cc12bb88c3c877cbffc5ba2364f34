95732cd8a5b9bf018866993083e426bc
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const refund_policy_util_1 = require("./refund-policy.util");
describe('computeRefundQuote', () => {
    const flagshipStartDate = new Date('2026-02-15T00:00:00+05:00');
    it('applies 100% for 15+ days before departure', () => {
        const submittedAt = new Date('2026-01-31T10:00:00+05:00'); // 15 days before (PKT)
        const quote = (0, refund_policy_util_1.computeRefundQuote)({
            flagshipStartDate,
            submittedAt,
            amountPaid: 10000,
        });
        expect(quote.daysBeforeDeparture).toBe(15);
        expect(quote.refundPercent).toBe(100);
        expect(quote.tierLabel).toBe('15+ days');
        expect(quote.processingFee).toBe(refund_policy_util_1.REFUND_PROCESSING_FEE_PKR);
        expect(quote.refundAmount).toBe(9500);
        expect(quote.policyLink).toBe(refund_policy_util_1.REFUND_POLICY_LINK);
    });
    it('applies 50% for 10-14 days before departure (inclusive)', () => {
        const submittedAt = new Date('2026-02-05T10:00:00+05:00'); // 10 days before
        const quote = (0, refund_policy_util_1.computeRefundQuote)({
            flagshipStartDate,
            submittedAt,
            amountPaid: 10000,
        });
        expect(quote.daysBeforeDeparture).toBe(10);
        expect(quote.refundPercent).toBe(50);
        expect(quote.tierLabel).toBe('10-14 days');
        expect(quote.refundAmount).toBe(4500);
    });
    it('applies 30% for 5-9 days before departure (inclusive)', () => {
        const submittedAt = new Date('2026-02-10T10:00:00+05:00'); // 5 days before
        const quote = (0, refund_policy_util_1.computeRefundQuote)({
            flagshipStartDate,
            submittedAt,
            amountPaid: 10000,
        });
        expect(quote.daysBeforeDeparture).toBe(5);
        expect(quote.refundPercent).toBe(30);
        expect(quote.tierLabel).toBe('5-9 days');
        expect(quote.refundAmount).toBe(2500);
    });
    it('applies 0% for 0-4 days before departure (inclusive)', () => {
        const submittedAt = new Date('2026-02-11T10:00:00+05:00'); // 4 days before
        const quote = (0, refund_policy_util_1.computeRefundQuote)({
            flagshipStartDate,
            submittedAt,
            amountPaid: 10000,
        });
        expect(quote.daysBeforeDeparture).toBe(4);
        expect(quote.refundPercent).toBe(0);
        expect(quote.tierLabel).toBe('0-4 days');
        expect(quote.refundAmount).toBe(0);
    });
    it('never returns a negative refund amount', () => {
        const submittedAt = new Date('2026-01-31T10:00:00+05:00'); // 15+ days
        const quote = (0, refund_policy_util_1.computeRefundQuote)({
            flagshipStartDate,
            submittedAt,
            amountPaid: 200,
        });
        expect(quote.refundPercent).toBe(100);
        expect(quote.refundAmount).toBe(0);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL2RldnByb2ZpbGUvRG9jdW1lbnRzL0dpdEh1Yi9tdXNhZmlyX2JhY2tlbmQvc3JjL3BheW1lbnQvcmVmdW5kLXBvbGljeS51dGlsLnNwZWMudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSw2REFJOEI7QUFFOUIsUUFBUSxDQUFDLG9CQUFvQixFQUFFLEdBQUcsRUFBRTtJQUNsQyxNQUFNLGlCQUFpQixHQUFHLElBQUksSUFBSSxDQUFDLDJCQUEyQixDQUFDLENBQUM7SUFFaEUsRUFBRSxDQUFDLDRDQUE0QyxFQUFFLEdBQUcsRUFBRTtRQUNwRCxNQUFNLFdBQVcsR0FBRyxJQUFJLElBQUksQ0FBQywyQkFBMkIsQ0FBQyxDQUFDLENBQUMsdUJBQXVCO1FBQ2xGLE1BQU0sS0FBSyxHQUFHLElBQUEsdUNBQWtCLEVBQUM7WUFDL0IsaUJBQWlCO1lBQ2pCLFdBQVc7WUFDWCxVQUFVLEVBQUUsS0FBSztTQUNsQixDQUFDLENBQUM7UUFFSCxNQUFNLENBQUMsS0FBSyxDQUFDLG1CQUFtQixDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQzNDLE1BQU0sQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBQ3RDLE1BQU0sQ0FBQyxLQUFLLENBQUMsU0FBUyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1FBQ3pDLE1BQU0sQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUMsSUFBSSxDQUFDLDhDQUF5QixDQUFDLENBQUM7UUFDNUQsTUFBTSxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDdEMsTUFBTSxDQUFDLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQyxJQUFJLENBQUMsdUNBQWtCLENBQUMsQ0FBQztJQUNwRCxDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyx5REFBeUQsRUFBRSxHQUFHLEVBQUU7UUFDakUsTUFBTSxXQUFXLEdBQUcs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L2RldnByb2ZpbGUvRG9jdW1lbnRzL0dpdEh1Yi9tdXNhZmlyX2JhY2tlbmQvc3JjL3BheW1lbnQvcmVmdW5kLXBvbGljeS51dGlsLnNwZWMudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgY29tcHV0ZVJlZnVuZFF1b3RlLFxuICBSRUZVTkRfUE9MSUNZX0xJTkssXG4gIFJFRlVORF9QUk9DRVNTSU5HX0ZFRV9QS1IsXG59IGZyb20gJy4vcmVmdW5kLXBvbGljeS51dGlsJztcblxuZGVzY3JpYmUoJ2NvbXB1dGVSZWZ1bmRRdW90ZScsICgpID0+IHtcbiAgY29uc3QgZmxhZ3NoaXBTdGFydERhdGUgPSBuZXcgRGF0ZSgnMjAyNi0wMi0xNVQwMDowMDowMCswNTowMCcpO1xuXG4gIGl0KCdhcHBsaWVzIDEwMCUgZm9yIDE1KyBkYXlzIGJlZm9yZSBkZXBhcnR1cmUnLCAoKSA9PiB7XG4gICAgY29uc3Qgc3VibWl0dGVkQXQgPSBuZXcgRGF0ZSgnMjAyNi0wMS0zMVQxMDowMDowMCswNTowMCcpOyAvLyAxNSBkYXlzIGJlZm9yZSAoUEtUKVxuICAgIGNvbnN0IHF1b3RlID0gY29tcHV0ZVJlZnVuZFF1b3RlKHtcbiAgICAgIGZsYWdzaGlwU3RhcnREYXRlLFxuICAgICAgc3VibWl0dGVkQXQsXG4gICAgICBhbW91bnRQYWlkOiAxMDAwMCxcbiAgICB9KTtcblxuICAgIGV4cGVjdChxdW90ZS5kYXlzQmVmb3JlRGVwYXJ0dXJlKS50b0JlKDE1KTtcbiAgICBleHBlY3QocXVvdGUucmVmdW5kUGVyY2VudCkudG9CZSgxMDApO1xuICAgIGV4cGVjdChxdW90ZS50aWVyTGFiZWwpLnRvQmUoJzE1KyBkYXlzJyk7XG4gICAgZXhwZWN0KHF1b3RlLnByb2Nlc3NpbmdGZWUpLnRvQmUoUkVGVU5EX1BST0NFU1NJTkdfRkVFX1BLUik7XG4gICAgZXhwZWN0KHF1b3RlLnJlZnVuZEFtb3VudCkudG9CZSg5NTAwKTtcbiAgICBleHBlY3QocXVvdGUucG9saWN5TGluaykudG9CZShSRUZVTkRfUE9MSUNZX0xJTkspO1xuICB9KTtcblxuICBpdCgnYXBwbGllcyA1MCUgZm9yIDEwLTE0IGRheXMgYmVmb3JlIGRlcGFydHVyZSAoaW5jbHVzaXZlKScsICgpID0+IHtcbiAgICBjb25zdCBzdWJtaXR0ZWRBdCA9IG5ldyBEYXRlKCcyMDI2LTAyLTA1VDEwOjAwOjAwKzA1OjAwJyk7IC8vIDEwIGRheXMgYmVmb3JlXG4gICAgY29uc3QgcXVvdGUgPSBjb21wdXRlUmVmdW5kUXVvdGUoe1xuICAgICAgZmxhZ3NoaXBTdGFydERhdGUsXG4gICAgICBzdWJtaXR0ZWRBdCxcbiAgICAgIGFtb3VudFBhaWQ6IDEwMDAwLFxuICAgIH0pO1xuXG4gICAgZXhwZWN0KHF1b3RlLmRheXNCZWZvcmVEZXBhcnR1cmUpLnRvQmUoMTApO1xuICAgIGV4cGVjdChxdW90ZS5yZWZ1bmRQZXJjZW50KS50b0JlKDUwKTtcbiAgICBleHBlY3QocXVvdGUudGllckxhYmVsKS50b0JlKCcxMC0xNCBkYXlzJyk7XG4gICAgZXhwZWN0KHF1b3RlLnJlZnVuZEFtb3VudCkudG9CZSg0NTAwKTtcbiAgfSk7XG5cbiAgaXQoJ2FwcGxpZXMgMzAlIGZvciA1LTkgZGF5cyBiZWZvcmUgZGVwYXJ0dXJlIChpbmNsdXNpdmUpJywgKCkgPT4ge1xuICAgIGNvbnN0IHN1Ym1pdHRlZEF0ID0gbmV3IERhdGUoJzIwMjYtMDItMTBUMTA6MDA6MDArMDU6MDAnKTsgLy8gNSBkYXlzIGJlZm9yZVxuICAgIGNvbnN0IHF1b3RlID0gY29tcHV0ZVJlZnVuZFF1b3RlKHtcbiAgICAgIGZsYWdzaGlwU3RhcnREYXRlLFxuICAgICAgc3VibWl0dGVkQXQsXG4gICAgICBhbW91bnRQYWlkOiAxMDAwMCxcbiAgICB9KTtcblxuICAgIGV4cGVjdChxdW90ZS5kYXlzQmVmb3JlRGVwYXJ0dXJlKS50b0JlKDUpO1xuICAgIGV4cGVjdChxdW90ZS5yZWZ1bmRQZXJjZW50KS50b0JlKDMwKTtcbiAgICBleHBlY3QocXVvdGUudGllckxhYmVsKS50b0JlKCc1LTkgZGF5cycpO1xuICAgIGV4cGVjdChxdW90ZS5yZWZ1bmRBbW91bnQpLnRvQmUoMjUwMCk7XG4gIH0pO1xuXG4gIGl0KCdhcHBsaWVzIDAlIGZvciAwLTQgZGF5cyBiZWZvcmUgZGVwYXJ0dXJlIChpbmNsdXNpdmUpJywgKCkgPT4ge1xuICAgIGNvbnN0IHN1Ym1pdHRlZEF0ID0gbmV3IERhdGUoJzIwMjYtMDItMTFUMTA6MDA6MDArMDU6MDAnKTsgLy8gNCBkYXlzIGJlZm9yZVxuICAgIGNvbnN0IHF1b3RlID0gY29tcHV0ZVJlZnVuZFF1b3RlKHtcbiAgICAgIGZsYWdzaGlwU3RhcnREYXRlLFxuICAgICAgc3VibWl0dGVkQXQsXG4gICAgICBhbW91bnRQYWlkOiAxMDAwMCxcbiAgICB9KTtcblxuICAgIGV4cGVjdChxdW90ZS5kYXlzQmVmb3JlRGVwYXJ0dXJlKS50b0JlKDQpO1xuICAgIGV4cGVjdChxdW90ZS5yZWZ1bmRQZXJjZW50KS50b0JlKDApO1xuICAgIGV4cGVjdChxdW90ZS50aWVyTGFiZWwpLnRvQmUoJzAtNCBkYXlzJyk7XG4gICAgZXhwZWN0KHF1b3RlLnJlZnVuZEFtb3VudCkudG9CZSgwKTtcbiAgfSk7XG5cbiAgaXQoJ25ldmVyIHJldHVybnMgYSBuZWdhdGl2ZSByZWZ1bmQgYW1vdW50JywgKCkgPT4ge1xuICAgIGNvbnN0IHN1Ym1pdHRlZEF0ID0gbmV3IERhdGUoJzIwMjYtMDEtMzFUMTA6MDA6MDArMDU6MDAnKTsgLy8gMTUrIGRheXNcbiAgICBjb25zdCBxdW90ZSA9IGNvbXB1dGVSZWZ1bmRRdW90ZSh7XG4gICAgICBmbGFnc2hpcFN0YXJ0RGF0ZSxcbiAgICAgIHN1Ym1pdHRlZEF0LFxuICAgICAgYW1vdW50UGFpZDogMjAwLFxuICAgIH0pO1xuXG4gICAgZXhwZWN0KHF1b3RlLnJlZnVuZFBlcmNlbnQpLnRvQmUoMTAwKTtcbiAgICBleHBlY3QocXVvdGUucmVmdW5kQW1vdW50KS50b0JlKDApO1xuICB9KTtcbn0pO1xuXG4iXSwidmVyc2lvbiI6M30=